<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dla Ciebie</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Quicksand:wght@400;500;600&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 30%, #f48fb1 60%, #f06292 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            color: #4a1942;
        }

        /* ── Particle hearts ── */
        .particles {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            bottom: -30px;
            opacity: 0;
            animation: rise linear infinite;
        }

        @keyframes rise {
            0%   { transform: translateY(0) translateX(0) scale(1); opacity: 0; }
            10%  { opacity: 0.4; }
            50%  { transform: translateY(-50vh) translateX(20px) scale(0.8); opacity: 0.3; }
            100% { transform: translateY(-105vh) translateX(-10px) scale(0.5); opacity: 0; }
        }

        /* ── Screens ── */
        .screen {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            padding: 20px;
            transition: opacity 1s ease, transform 1s ease;
        }

        .screen.hidden {
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
        }

        /* ── Screen 1: Drawing heart ── */
        #screen-heart {
            cursor: pointer;
        }

        .heart-container {
            position: relative;
            width: 200px;
            height: 185px;
        }

        .draw-heart {
            width: 200px;
            height: 185px;
            overflow: visible;
        }

        .draw-heart .heart-outline {
            fill: none;
            stroke: #e91e63;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            stroke-dasharray: 520;
            stroke-dashoffset: 520;
            animation: drawHeart 2.5s ease forwards;
        }

        .draw-heart .heart-filled {
            fill: #e91e63;
            opacity: 0;
            animation: fillHeart 0.8s ease forwards 2.3s;
            filter: drop-shadow(0 4px 15px rgba(233,30,99,0.35));
        }

        @keyframes drawHeart {
            to { stroke-dashoffset: 0; }
        }

        @keyframes fillHeart {
            from { opacity: 0; }
            to   { opacity: 1; }
        }

        .heart-container::after {
            content: '';
            position: absolute;
            inset: 0;
            animation: pulseGlow 2s ease-in-out infinite 3s;
            opacity: 0;
        }

        @keyframes pulseGlow {
            0%, 100% { opacity: 0; transform: scale(1); }
            50%      { opacity: 1; transform: scale(1.05); }
        }

        .tap-text {
            margin-top: 30px;
            font-family: 'Caveat', cursive;
            font-size: 1.6rem;
            font-weight: 600;
            color: rgba(194,24,91,0.6);
            opacity: 0;
            animation: fadeInSoft 1s ease forwards 3s;
        }

        @keyframes fadeInSoft {
            to { opacity: 1; }
        }

        /* ── Screen 2: Letter ── */
        .glass-card {
            background: rgba(255,255,255,0.35);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: 24px;
            padding: 40px 35px;
            max-width: 520px;
            width: 100%;
            text-align: center;
            box-shadow: 0 8px 32px rgba(180,60,100,0.15);
            position: relative;
            overflow: auto;
            max-height: 80vh;
        }

        .card-heart {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: block;
            animation: gentlePulse 2s ease-in-out infinite;
        }

        @keyframes gentlePulse {
            0%, 100% { transform: scale(1); }
            50%      { transform: scale(1.1); }
        }

        .card-title {
            font-family: 'Caveat', cursive;
            font-size: 2.4rem;
            font-weight: 700;
            color: #c2185b;
            margin-bottom: 20px;
        }

        .card-body {
            font-size: 1.1rem;
            font-weight: 500;
            line-height: 1.9;
            color: rgba(74,25,66,0.85);
            margin-bottom: 25px;
        }

        .card-body p {
            margin-bottom: 12px;
        }

        .card-question {
            font-family: 'Caveat', cursive;
            font-size: 2.5rem;
            font-weight: 700;
            color: #c2185b;
            margin: 25px 0 30px;
            line-height: 1.3;
        }

        /* ── Buttons ── */
        .buttons-row {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            position: relative;
            min-height: 120px;
            width: 100%;
        }

        .btn {
            font-family: 'Caveat', cursive;
            font-size: 1.6rem;
            font-weight: 700;
            padding: 14px 45px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 1px;
        }

        .btn-yes {
            background: linear-gradient(135deg, #e91e63, #f06292);
            color: white;
            box-shadow: 0 6px 25px rgba(233,30,99,0.35);
        }

        .btn-yes:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 35px rgba(233,30,99,0.5);
        }

        .btn-no {
            background: rgba(255,255,255,0.5);
            color: rgba(74,25,66,0.5);
            border: 1px solid rgba(194,24,91,0.2);
            font-size: 1.2rem;
            padding: 10px 30px;
            transition: transform 0.25s ease, opacity 0.3s ease;
            white-space: nowrap;
            position: relative;
            z-index: 10;
        }

        /* ── Screen 3: Celebration ── */
        .celeb-card {
            text-align: center;
            position: relative;
        }

        .celeb-heart {
            font-size: 5rem;
            display: inline-block;
            animation: gentlePulse 1.5s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(233,30,99,0.4));
        }

        .celeb-title {
            font-family: 'Caveat', cursive;
            font-size: 3.2rem;
            font-weight: 700;
            color: #c2185b;
            margin: 15px 0;
        }

        .celeb-text {
            font-size: 1.25rem;
            font-weight: 500;
            color: rgba(74,25,66,0.8);
            line-height: 1.8;
            max-width: 450px;
        }

        .celeb-text p {
            margin-bottom: 10px;
        }

        .celeb-date {
            margin-top: 30px;
            font-family: 'Caveat', cursive;
            font-size: 1.5rem;
            font-weight: 600;
            color: rgba(194,24,91,0.5);
        }

        /* ── Heart rings celebration ── */
        .heart-ring {
            position: fixed;
            pointer-events: none;
            z-index: 100;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            font-size: 2rem;
            white-space: nowrap;
        }

        @keyframes ringExpand {
            0%   { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            60%  { opacity: 0.8; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }

        /* ── Falling celebration hearts ── */
        .fall-heart {
            position: fixed;
            z-index: 99;
            pointer-events: none;
            animation: floatDown ease-in forwards;
        }

        @keyframes floatDown {
            0%   { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(360deg); opacity: 0.3; }
        }

        /* ── Responsive ── */
        @media (max-width: 600px) {
            .glass-card {
                padding: 25px 18px;
                margin: 10px;
            }
            .card-title { font-size: 1.9rem; }
            .card-body { font-size: 1rem; }
            .card-question { font-size: 2rem; }
            .btn-yes { font-size: 1.4rem; padding: 12px 35px; }
            .btn-no { font-size: 1rem; padding: 8px 25px; }
            .celeb-title { font-size: 2.5rem; }
            .celeb-text { font-size: 1.05rem; }
            .heart-container { transform: scale(0.85); }
        }
    </style>
</head>
<body>

<div class="particles" id="particles"></div>

<!-- Screen 1: Drawing heart -->
<div class="screen" id="screen-heart" onclick="openLetter()">
    <div class="heart-container">
        <svg class="draw-heart" viewBox="0 0 100 90" xmlns="http://www.w3.org/2000/svg">
            <path class="heart-outline"
                d="M50,85 C50,85 5,55 5,30 A22.5,22.5 0,0,1 50,20 A22.5,22.5 0,0,1 95,30 C95,55 50,85 50,85Z"/>
            <path class="heart-filled"
                d="M50,85 C50,85 5,55 5,30 A22.5,22.5 0,0,1 50,20 A22.5,22.5 0,0,1 95,30 C95,55 50,85 50,85Z"/>
        </svg>
    </div>
    <div class="tap-text">Dotknij serduszko...</div>
</div>

<!-- Screen 2: Letter -->
<div class="screen hidden" id="screen-letter">
    <div class="glass-card">
        <div class="card-heart">&#128149;</div>
        <div class="card-title">{{ title }}</div>
        <div class="card-body">
            {% for p in body %}<p>{{ p }}</p>{% endfor %}
        </div>
        <div class="card-question">Czy zostaniesz moją Walentynką?</div>
        <div class="buttons-row" id="buttonsRow">
            <button class="btn btn-yes" onclick="sayYes()">Tak! &#128151;</button>
            <button class="btn btn-no" id="btnNo" onclick="escapeBtn()" onmouseenter="showEscapeHint()" ontouchstart="showEscapeHint()">Nie</button>
        </div>
    </div>
</div>

<!-- Screen 3: Celebration -->
<div class="screen hidden" id="screen-celebration">
    <div class="celeb-card">
        <div class="celeb-heart">&#128150;</div>
        <div class="celeb-title">{{ celeb_title }}</div>
        <div class="celeb-text">
            {% for p in celeb_text %}<p>{{ p }}</p>{% endfor %}
            <p>Kocham Cię najbardziej na świecie &#128151;</p>
        </div>
        <div class="celeb-date">~ 14 lutego 2026 ~</div>
    </div>
</div>

<script>
    // ── Floating particles ──
    function createParticles() {
        const container = document.getElementById('particles');
        const symbols = ['\u2661', '\u2665', '\u273F', '\u2740', '\u00B7', '\u2727'];

        for (let i = 0; i < 20; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.textContent = symbols[Math.floor(Math.random() * symbols.length)];
            p.style.left = Math.random() * 100 + '%';
            p.style.fontSize = (10 + Math.random() * 18) + 'px';
            p.style.color = `hsla(${330 + Math.random() * 30}, 80%, ${60 + Math.random() * 20}%, 0.5)`;
            p.style.animationDuration = (10 + Math.random() * 14) + 's';
            p.style.animationDelay = Math.random() * 12 + 's';
            container.appendChild(p);
        }
    }
    createParticles();

    // ── Screen transitions ──
    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
        setTimeout(() => {
            document.getElementById(id).classList.remove('hidden');
        }, 200);
    }

    function openLetter() {
        showScreen('screen-letter');
    }

    // ── Escaping "No" button ──
    let escapeCount = 0;
    let hintShown = false;
    const phases = [
        { range: 0.3, texts: ['Hmm... na pewno?', 'Pomyśl jeszcze raz!', 'Ej, no weź!'] },
        { range: 0.5, texts: ['Serio "Nie"?!', 'Nie ma takiej opcji!', 'Nawet nie próbuj!'] },
        { range: 0.8, texts: ['No dobra, poddaję się...', 'A nie, żartowałem!', '...'] },
    ];

    function getPhase() {
        if (escapeCount < 3) return phases[0];
        if (escapeCount < 6) return phases[1];
        return phases[2];
    }

    function showEscapeHint() {
        if (!hintShown) {
            const btn = document.getElementById('btnNo');
            btn.textContent = 'Nie tego nie klikaj';
            hintShown = true;
        }
    }

    function escapeBtn() {
        const btn = document.getElementById('btnNo');
        const phase = getPhase();
        const phaseIndex = escapeCount < 3 ? escapeCount : (escapeCount < 6 ? escapeCount - 3 : escapeCount - 6);

        const distance = 40 + phase.range * 120;
        const angle = Math.random() * Math.PI * 2;
        const moveX = Math.cos(angle) * distance;
        const moveY = Math.sin(angle) * distance * 0.5;

        btn.style.transform = `translate(${moveX}px, ${moveY}px)`;

        if (phaseIndex < phase.texts.length) {
            btn.textContent = phase.texts[phaseIndex];
        }

        escapeCount++;
        hintShown = true;

        const yesBtn = document.querySelector('.btn-yes');
        const newScale = 1 + escapeCount * 0.04;
        yesBtn.style.transform = `scale(${Math.min(newScale, 1.5)})`;

        if (escapeCount >= 9) {
            btn.style.transform = 'translate(0, 0) scale(0)';
            btn.style.opacity = '0';
            setTimeout(() => { btn.style.display = 'none'; }, 300);
        }
    }

    // ── Celebration ──
    function sayYes() {
        showScreen('screen-celebration');
        createRing(0);
        createRing(500);
        createRing(1000);
        spawnFallingHearts();
    }

    function createRing(delay) {
        setTimeout(() => {
            const ring = document.createElement('div');
            ring.className = 'heart-ring';
            ring.textContent = '\uD83D\uDC96 \uD83D\uDC97 \uD83D\uDC95 \uD83D\uDC96 \uD83D\uDC97 \uD83D\uDC95 \uD83D\uDC96 \uD83D\uDC97';
            ring.style.animation = 'ringExpand 2s ease-out forwards';
            document.body.appendChild(ring);
            setTimeout(() => ring.remove(), 2100);
        }, delay);
    }

    function spawnFallingHearts() {
        const hearts = ['\uD83D\uDC96', '\uD83D\uDC95', '\uD83D\uDC97', '\uD83C\uDF38', '\u2665'];
        for (let i = 0; i < 15; i++) {
            setTimeout(() => {
                const el = document.createElement('div');
                el.className = 'fall-heart';
                el.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                el.style.left = (5 + Math.random() * 90) + 'vw';
                el.style.top = '-30px';
                el.style.fontSize = (16 + Math.random() * 20) + 'px';
                el.style.animationDuration = (3 + Math.random() * 3) + 's';
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 6500);
            }, i * 200);
        }
    }
</script>

</body>
</html>
